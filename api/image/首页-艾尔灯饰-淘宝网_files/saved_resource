KISSY.add("modules/component/taojinbi/index",function(a,b,c,d,e){function f(a){var b=this;b.config=a,b.sellerId=a.sellerId,b.token=a.token,b.init()}var g=location.host.indexOf("daily.")>=0,h=g?"//api-taojinbi.daily.taobao.net":"//api-taojinbi.taobao.com",i=h+"/json/signin_status.htm",j=h+"/json/signin_detail.htm",k=h+"/json/signin.htm",l=g?"//site.daily.taobao.net":"//site.taobao.com",m=l+"/page-25130.htm",n="<div class='J_SigninBox tb-signin-box'>             <div class='signin-wrap'>             {{#if isSuccess}}             <h3>\u606d\u559c\u4f60\u83b7\u5f97<em>{{succ_coins}}</em>\u4e2a\u6dd8\u91d1\u5e01</h3>             <p>\u4f60\u5df2\u7b7e\u5230<em>{{sign_days}}</em>\u5929\uff0c\u5171\u83b7\u5f97\u638c\u67dc<em>{{sign_coin_sum}}</em>\u4e2a\u6dd8\u91d1\u5e01\u3002</p>             <p>\u8fde\u7eed\u7b7e\u5230<em>{{act_ext_days}}</em>\u5929\uff0c\u8fd8\u53ef\u4ee5\u989d\u5916\u83b7\u5f97<em>{{act_ext_num}}</em>\u4e2a\uff0c\u52a0\u6cb9\u54e6\uff01</p>                 {{#if act_start_time}} <p>\u6d3b\u52a8\u65f6\u95f4\uff1a{{act_start_time}} - {{act_end_time}}</p>             {{/if}}             {{else}}             <h3>{{err_msg}}</h3>             {{#if err_code===0-4}}             <p>\u638c\u67dc\u7ed9\u4e86\u54b1\u91d1\u5e01\uff0c\u54b1\u53bb<a href='{{shopUrl}}'>\u638c\u67dc\u5e97\u94fa</a>\u901b\u901b{{#if dq_act_status}}\uff0c\u5168\u5e97\u6dd8\u91d1\u5e01\u62b5\u94b1\u6d3b\u52a8\u8fdb\u884c\u4e2d\uff01{{/if}}</p>             {{else}}             <p>\u6765\u90fd\u6765\u4e86\uff0c\u53bb<a href='{{shopUrl}}'>\u638c\u67dc\u5e97\u94fa</a>\u901b\u901b{{#if dq_act_status}}\uff0c\u5168\u5e97\u6dd8\u91d1\u5e01\u62b5\u94b1\u6d3b\u52a8\u8fdb\u884c\u4e2d\uff01{{/if}}</p>             {{/if}}             {{/if}}             {{#if coin_sum}}             <p class='summary'>\u4f60\u7684\u6dd8\u91d1\u5e01\u603b\u8ba1<em>{{coin_sum}}</em>\u4e2a\uff0c\u6700\u5c11\u53ef\u62b5<em>{{coin_sum_money}}</em>\u5143</p>             {{/if}}             <p class='ctrl-btn'>             <a href='{{shopUrl}}' class='J_THuaJinBi'>\u901b\u5e97\u94fa\u82b1\u91d1\u5e01</a>             </p>             </div>             <i class='close-btn'>&#9587;</i>             </div>";return a.augment(f,{init:function(){},signin:function(a){var b=this,c=k;b._checkLogin(function(){d({url:c,dataType:"jsonp",data:{seller_id:b.sellerId,_tb_token_:b.token},success:function(c){b._applyHandler(c,a)},error:function(){b._signFailHandler.call(b)}})})},getActStatus:function(b){var c=this,d=m;a.jsonp(d,{uid:c.sellerId},b)},isSign:function(b){var c=this;if(!TB.Global.isLogin)return void b({has_signed:!1,msg:"\u7528\u6237\u672a\u767b\u5f55"});var d=i;a.jsonp(d,{seller_id:c.sellerId},b)},signDetail:function(b,c,d){var e=this;if(!TB.Global.isLogin)return void b({msg:"\u7528\u6237\u672a\u767b\u5f55"});var f=j;a.jsonp(f,{seller_id:e.sellerId,from:c,to:d},b)},_checkLogin:function(a){TB.Global.use("fn-login",function(b,c){c.Mini.popup(a)})},_applyHandler:function(b,c){var d=this,e=b.isSuccess,f=a.clone(b);if(b.act_start_time){var g={year:"numeric",month:"numeric",day:"numeric"};f.act_start_time=new Date(b.act_start_time).toLocaleDateString("zh-Hans",g),f.act_end_time=new Date(b.act_end_time).toLocaleDateString("zh-Hans",g)}d.success=e,f.shopUrl=d.config.shopUrl,d._popup(f),c(b)},_signFailHandler:function(){var a=this,b={err_msg:"\u7cfb\u7edf\u9003\u547d\u53bb\u4e86\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5"};a._popup(b)},_popup:function(a){var d=this;d.popupEl&&b.remove(d.popupEl),d.popupEl=b.create(new e(n).render(a));var f=b.get(".close-btn",d.popupEl);c.on(f,"click",function(){b.hide(d.popupEl)}),b.append(d.popupEl,"body")}}),f},{requires:["dom","event","ajax","xtemplate","./default.css"]});